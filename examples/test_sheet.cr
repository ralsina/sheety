
        require "croupier"
        require "tablo"
        require "../src/sheety/functions/registry"

        # Auto-generated Excel formula tasks for Croupier
        # Generated by Sheety

      
# Set initial cell values
Croupier::TaskManager.set("Sheet1!A1", "100.0")
Croupier::TaskManager.set("Sheet1!A2", "200.0")
Croupier::TaskManager.set("Sheet1!A3", "300.0")
Croupier::TaskManager.set("Sheet1!B1", "Hello")
Croupier::TaskManager.set("Sheet1!B2", "World")
Croupier::TaskManager.set("Sheet1!C1", "5.0")
Croupier::TaskManager.set("Sheet1!C2", "3.0")
Croupier::TaskManager.set("Sheet2!A1", "100.0")



        Croupier::Task.new(
          id: "formula_Sheet1_A4",
          inputs: ["kv://Sheet1!A1", "kv://Sheet1!A2", "kv://Sheet1!A3"],
          outputs: ["kv://Sheet1!A4"],
        ) do
          begin
            result = (Sheety::Functions.sum([(Croupier::TaskManager.get("Sheet1!A1") || ""), (Croupier::TaskManager.get("Sheet1!A2") || ""), (Croupier::TaskManager.get("Sheet1!A3") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet1_A5",
          inputs: ["kv://Sheet1!A1", "kv://Sheet1!A2", "kv://Sheet1!A3"],
          outputs: ["kv://Sheet1!A5"],
        ) do
          begin
            result = (Sheety::Functions.average([(Croupier::TaskManager.get("Sheet1!A1") || ""), (Croupier::TaskManager.get("Sheet1!A2") || ""), (Croupier::TaskManager.get("Sheet1!A3") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet1_B3",
          inputs: ["kv://Sheet1!B1", "kv://Sheet1!B2"],
          outputs: ["kv://Sheet1!B3"],
        ) do
          begin
            result = (Sheety::Functions.concat([(Croupier::TaskManager.get("Sheet1!B1") || ""), " ", (Croupier::TaskManager.get("Sheet1!B2") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet1_C3",
          inputs: ["kv://Sheet1!C1", "kv://Sheet1!C2"],
          outputs: ["kv://Sheet1!C3"],
        ) do
          begin
            result = (Sheety::Functions.if(Sheety::Functions.gt((Croupier::TaskManager.get("Sheet1!C1") || ""), (Croupier::TaskManager.get("Sheet1!C2") || "")), "Yes", "No"))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet1_D1",
          inputs: ["kv://Sheet1!A1", "kv://Sheet1!A2", "kv://Sheet1!A3"],
          outputs: ["kv://Sheet1!D1"],
        ) do
          begin
            result = (Sheety::Functions.max([(Croupier::TaskManager.get("Sheet1!A1") || ""), (Croupier::TaskManager.get("Sheet1!A2") || ""), (Croupier::TaskManager.get("Sheet1!A3") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet1_D2",
          inputs: ["kv://Sheet1!A1", "kv://Sheet1!A2", "kv://Sheet1!A3"],
          outputs: ["kv://Sheet1!D2"],
        ) do
          begin
            result = (Sheety::Functions.min([(Croupier::TaskManager.get("Sheet1!A1") || ""), (Croupier::TaskManager.get("Sheet1!A2") || ""), (Croupier::TaskManager.get("Sheet1!A3") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet2_A2",
          inputs: ["kv://Sheet1!A4"],
          outputs: ["kv://Sheet2!A2"],
        ) do
          begin
            result = (begin; ln = Sheety::Functions.to_float((Croupier::TaskManager.get("Sheet1!A4") || "")); rn = Sheety::Functions.to_float(2.0); (ln && rn) ? (ln * rn).to_s : nil; end)

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


        Croupier::Task.new(
          id: "formula_Sheet2_A3",
          inputs: ["kv://Sheet1!A1", "kv://Sheet1!A2"],
          outputs: ["kv://Sheet2!A3"],
        ) do
          begin
            result = (Sheety::Functions.sum([(Croupier::TaskManager.get("Sheet1!A1") || ""), (Croupier::TaskManager.get("Sheet1!A2") || "")]))

            # Convert result to string - this is what the task "outputs"
            case result
            when Float64
              if result == result.to_i
                result.to_i.to_s
              else
                result.to_s
              end
            when String
              result
            when Bool
              result.upcase.to_s
            when Sheety::Functions::ErrorValue
              result.to_s
            when Nil
              ""
            else
              result.to_s
            end
          rescue e : Exception
            "#ERROR: " + (e.message || "Unknown error")
          end
        end
      


# Execute all tasks
puts "=== Executing Croupier Tasks ==="
Croupier::TaskManager.run_tasks

# Display results in a table
puts ""
puts "=== Spreadsheet Results ==="
puts ""

# Get all cell values
cell_values = {
  "Sheet1!A4" => Croupier::TaskManager.get("Sheet1!A4"),
  "Sheet1!A5" => Croupier::TaskManager.get("Sheet1!A5"),
  "Sheet1!B3" => Croupier::TaskManager.get("Sheet1!B3"),
  "Sheet1!C3" => Croupier::TaskManager.get("Sheet1!C3"),
  "Sheet1!D1" => Croupier::TaskManager.get("Sheet1!D1"),
  "Sheet1!D2" => Croupier::TaskManager.get("Sheet1!D2"),
  "Sheet2!A2" => Croupier::TaskManager.get("Sheet2!A2"),
  "Sheet2!A3" => Croupier::TaskManager.get("Sheet2!A3")
}

# Create table data
table_data = cell_values.map do |key, value|
  sheet, cell = key.split("!", 2)
  {sheet: sheet, cell: cell, value: value || "(empty)"}
end

# Create and print table
table = Tablo::Table.new(table_data) do |t|
  t.add_column(:sheet, header: "Sheet") { |d| d[:sheet] }
  t.add_column(:cell, header: "Cell") { |d| d[:cell] }
  t.add_column(:value, header: "Value") { |d| d[:value] }
end

puts table
puts ""
